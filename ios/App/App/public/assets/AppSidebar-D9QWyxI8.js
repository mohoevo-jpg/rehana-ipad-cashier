import{_ as K}from"./logo-Cbfr3TE7.js";import{g as Q,h as Z,f as F,r as B,l as ee,i as $,j as H,k as Y,c as v,o as f,b as r,d as C,m as k,n as D,t as _,F as V,p as q,q as N,s as W,x as J,u as te,y as se,z as ne,A as re,B as j,C as oe}from"./index-D6fbium0.js";import{c as S,t as u,a as ae,g as U,b as le,e as ie,m as X,d as z,P as ce,U as P,S as G,f as ue}from"./ar-BoWEtPll.js";const de=Q("branches",{state:()=>({branches:JSON.parse(localStorage.getItem("branches"))||[{id:"1",name:"الفرع الرئيسي",location:"الموصل - حي الزهور",phone:"07700000000"}]}),getters:{getAllBranches:s=>s.branches,getBranchById:s=>e=>s.branches.find(t=>t.id===e)},actions:{addBranch(s){const e={...s,id:Z()};this.branches.push(e),this.saveToLocalStorage()},updateBranch(s){const e=this.branches.findIndex(t=>t.id===s.id);e!==-1&&(this.branches[e]=s,this.saveToLocalStorage())},deleteBranch(s){this.branches=this.branches.filter(e=>e.id!==s),this.saveToLocalStorage()},saveToLocalStorage(){localStorage.setItem("branches",JSON.stringify(this.branches))}}});/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=S("ActivityIcon",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=S("BellOffIcon",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=S("BellIcon",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=S("LogOutIcon",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=S("MegaphoneIcon",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=S("MenuIcon",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=S("SettingsIcon",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function T(s,e){const t=u(s),l=u(e),n=t.getTime()-l.getTime();return n<0?-1:n>0?1:n}function pe(s){return ae(s,Date.now())}function xe(s,e){const t=u(s),l=u(e),n=t.getFullYear()-l.getFullYear(),p=t.getMonth()-l.getMonth();return n*12+p}function be(s){return e=>{const l=(s?Math[s]:Math.trunc)(e);return l===0?0:l}}function we(s,e){return+u(s)-+u(e)}function _e(s){const e=u(s);return e.setHours(23,59,59,999),e}function ke(s){const e=u(s),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Me(s){const e=u(s);return+_e(e)==+ke(e)}function De(s,e){const t=u(s),l=u(e),n=T(t,l),p=Math.abs(xe(t,l));let h;if(p<1)h=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-n*p);let a=T(t,l)===-n;Me(u(s))&&p===1&&T(s,l)===1&&(a=!1),h=n*(p-Number(a))}return h===0?0:h}function Se(s,e,t){const l=we(s,e)/1e3;return be(t==null?void 0:t.roundingMethod)(l)}function Ie(s,e,t){const l=le(),n=(t==null?void 0:t.locale)??l.locale??ie,p=2520,h=T(s,e);if(isNaN(h))throw new RangeError("Invalid time value");const a=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:h});let d,w;h>0?(d=u(e),w=u(s)):(d=u(s),w=u(e));const g=Se(w,d),x=(U(w)-U(d))/1e3,c=Math.round((g-x)/60);let b;if(c<2)return t!=null&&t.includeSeconds?g<5?n.formatDistance("lessThanXSeconds",5,a):g<10?n.formatDistance("lessThanXSeconds",10,a):g<20?n.formatDistance("lessThanXSeconds",20,a):g<40?n.formatDistance("halfAMinute",0,a):g<60?n.formatDistance("lessThanXMinutes",1,a):n.formatDistance("xMinutes",1,a):c===0?n.formatDistance("lessThanXMinutes",1,a):n.formatDistance("xMinutes",c,a);if(c<45)return n.formatDistance("xMinutes",c,a);if(c<90)return n.formatDistance("aboutXHours",1,a);if(c<X){const m=Math.round(c/60);return n.formatDistance("aboutXHours",m,a)}else{if(c<p)return n.formatDistance("xDays",1,a);if(c<z){const m=Math.round(c/X);return n.formatDistance("xDays",m,a)}else if(c<z*2)return b=Math.round(c/z),n.formatDistance("aboutXMonths",b,a)}if(b=De(w,d),b<12){const m=Math.round(c/z);return n.formatDistance("xMonths",m,a)}else{const m=b%12,M=Math.trunc(b/12);return m<3?n.formatDistance("aboutXYears",M,a):m<9?n.formatDistance("overXYears",M,a):n.formatDistance("almostXYears",M+1,a)}}function Ce(s,e){return Ie(s,pe(s),e)}const Oe={key:0,class:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center border-2 border-white"},Le={key:0,class:"absolute left-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-100 z-50 overflow-hidden"},$e={class:"p-3 border-b border-gray-100 flex justify-between items-center"},Be={class:"max-h-96 overflow-y-auto"},ze={key:0,class:"p-8 text-center text-gray-500"},Te=["onClick"],Re={class:"flex gap-3"},Ne={class:"flex-1 min-w-0"},Ae={class:"text-sm font-medium text-gray-900 truncate"},je={class:"text-xs text-gray-500 mt-1"},Ue={__name:"NotificationsDropdown",setup(s){const e=F(),t=B(!1),l=B([]),n=B(null),h=!!(window.process&&window.process.versions&&window.process.versions.electron)?"http://localhost:3001":"",a=ee(h,{path:"/socket.io"}),d=$(()=>l.value.filter(o=>!o.read).length),w=()=>{t.value=!t.value},g=o=>{n.value&&!n.value.contains(o.target)&&(t.value=!1)},x=()=>{l.value.forEach(o=>o.read=!0)},c=o=>{o.read=!0,e.push("/activity-logs"),t.value=!1},b=()=>{e.push("/activity-logs"),t.value=!1},m=o=>Ce(new Date(o),{addSuffix:!0,locale:ue}),M=o=>({order:G,user:P,product:ce,campaign:ge,settings:ve,system:E})[o]||E,R=o=>({order:"bg-blue-100 text-blue-600",user:"bg-green-100 text-green-600",product:"bg-purple-100 text-purple-600",campaign:"bg-orange-100 text-orange-600",settings:"bg-gray-200 text-gray-600",system:"bg-red-100 text-red-600"})[o]||"bg-gray-100 text-gray-600";return H(()=>{document.addEventListener("click",g),a.on("new-activity",o=>{l.value.unshift({...o,read:!1}),["order","system"].includes(o.type),l.value.length>20&&(l.value=l.value.slice(0,20))})}),Y(()=>{document.removeEventListener("click",g),a.disconnect()}),(o,i)=>(f(),v("div",{class:"relative",ref_key:"dropdownRef",ref:n},[r("button",{onClick:w,class:"relative p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors focus:outline-none"},[k(D(he),{class:"w-6 h-6"}),d.value>0?(f(),v("span",Oe,_(d.value>9?"9+":d.value),1)):C("",!0)]),t.value?(f(),v("div",Le,[r("div",$e,[i[0]||(i[0]=r("h3",{class:"font-semibold text-gray-800"},"الإشعارات",-1)),d.value>0?(f(),v("button",{key:0,onClick:x,class:"text-xs text-primary-600 hover:text-primary-800 font-medium"}," تحديد الكل كمقروء ")):C("",!0)]),r("div",Be,[l.value.length===0?(f(),v("div",ze,[k(D(fe),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),i[1]||(i[1]=r("p",{class:"text-sm"},"لا توجد إشعارات جديدة",-1))])):C("",!0),(f(!0),v(V,null,q(l.value,y=>(f(),v("div",{key:y.id,class:N(["p-3 border-b border-gray-50 hover:bg-gray-50 transition-colors cursor-pointer",{"bg-blue-50/50":!y.read}]),onClick:O=>c(y)},[r("div",Re,[r("div",{class:N([R(y.type),"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0"])},[(f(),W(J(M(y.type)),{class:"w-4 h-4"}))],2),r("div",Ne,[r("p",Ae,_(y.message),1),r("p",je,_(m(y.timestamp)),1)])])],10,Te))),128))]),r("div",{class:"p-2 border-t border-gray-100 bg-gray-50 text-center"},[r("button",{onClick:b,class:"text-sm text-primary-600 hover:text-primary-800 font-medium w-full py-1"}," عرض كل النشاطات ")])])):C("",!0)],512))}},Xe={class:"flex h-screen bg-gray-100 overflow-hidden"},Ee={class:"flex-1 overflow-y-auto py-4 min-w-[16rem]"},Fe={class:"space-y-1 px-2"},He={class:"flex items-center"},Ye={key:0,class:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full"},Ve={class:"p-4 border-t min-w-[16rem]"},qe={class:"flex-1 overflow-hidden flex flex-col relative w-full transition-all duration-300"},We={class:"bg-white shadow-sm p-4 flex justify-between items-center z-10"},Je={class:"flex items-center gap-3"},Pe={class:"text-xl font-semibold text-gray-800"},Ge={class:"flex items-center space-x-4 space-x-reverse"},Ke={class:"flex items-center"},Qe={class:"flex flex-col items-end ml-3"},Ze={class:"text-sm font-medium text-gray-800"},et={class:"text-xs text-gray-500"},tt={class:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center text-primary-600"},st={class:"flex-1 overflow-auto p-6"},lt={__name:"AppSidebar",setup(s){const e=te(),t=se(),l=de(),n=ne(),p=F(),h=re(),a=B(window.innerWidth>=1024),d=B(window.innerWidth<1024),w=()=>{a.value=!a.value},g=()=>{const o=window.innerWidth<1024;o!==d.value&&(d.value=o,a.value=!o)};H(()=>{window.addEventListener("resize",g)}),Y(()=>{window.removeEventListener("resize",g)});const x=$(()=>{var o;if((o=e.currentUser)!=null&&o.id){const i=t.getUserById(e.currentUser.id);if(i)return i}return e.currentUser}),c=$(()=>!x.value||!x.value.branchId?null:l.branches.find(o=>o.id===x.value.branchId)),b=$(()=>h.name?h.name.toLowerCase():"cashier"),m=[{key:"cashier",route:"Cashier",icon:G}],M=$(()=>{var y,O;const o=((y=x.value)==null?void 0:y.permissions)||[],i=(O=x.value)==null?void 0:O.role;return i==="admin"||o.includes("all")?m:m.filter(L=>i==="cashier"&&L.key==="complaints"?!0:o.includes(L.key))}),R=()=>{e.logout(),p.push("/login")};return(o,i)=>{var L,A;const y=j("router-link"),O=j("router-view");return f(),v("div",Xe,[a.value?(f(),v("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:i[0]||(i[0]=I=>a.value=!1)})):C("",!0),r("aside",{class:N(["bg-white shadow-md flex flex-col z-30 transition-all duration-300 h-full",["fixed inset-y-0 right-0 lg:static lg:inset-auto",a.value?"translate-x-0 w-64":"translate-x-full lg:translate-x-0 lg:w-0 lg:overflow-hidden"]])},[i[2]||(i[2]=r("div",{class:"p-4 border-b flex items-center justify-center py-8 min-w-[16rem]"},[r("img",{src:K,alt:"Rehana",class:"w-48 h-auto object-contain transition-all duration-300 hover:scale-105"})],-1)),r("nav",Ee,[r("ul",Fe,[(f(!0),v(V,null,q(M.value,I=>(f(),v("li",{key:I.route},[k(y,{to:{name:I.route},class:"flex items-center justify-between px-4 py-3 text-gray-600 rounded-lg hover:bg-primary-50 hover:text-primary-600 transition-colors","active-class":"bg-primary-50 text-primary-600 font-medium",onClick:i[1]||(i[1]=nt=>d.value&&(a.value=!1))},{default:oe(()=>[r("div",He,[(f(),W(J(I.icon),{class:"w-5 h-5 ml-3"})),r("span",null,_(o.$t(`menu.${I.key}`)),1)]),I.key==="online_orders"&&D(n).newOrdersCount>0?(f(),v("span",Ye,_(D(n).newOrdersCount),1)):C("",!0)]),_:2},1032,["to"])]))),128))])]),r("div",Ve,[r("button",{onClick:R,class:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[k(D(me),{class:"w-5 h-5 ml-3"}),r("span",null,_(o.$t("menu.logout")),1)])])],2),r("main",qe,[r("header",We,[r("div",Je,[r("button",{onClick:w,class:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 focus:outline-none"},[k(D(ye),{class:"w-6 h-6"})]),r("h2",Pe,_(o.$t(`menu.${b.value}`)),1)]),r("div",Ge,[k(Ue),r("div",Ke,[r("div",Qe,[r("span",Ze,_((L=x.value)==null?void 0:L.name),1),r("span",et,_(((A=c.value)==null?void 0:A.name)||"الفرع الرئيسي"),1)]),r("div",tt,[k(D(P),{class:"w-5 h-5"})])])])]),r("div",st,[k(O)])])])}}};export{lt as default};
